library(rgdal)
library(stringr)
library(shinydashboard)
library(tidyverse)
library(tidyr)
library(naniar)
load('../output/School_Locations.RData')
SS_17 <- read_csv('../data/School Survey 2017.csv')
SS_18 <- read_csv('../data/School Survey 2018.csv')
SS_19 <- read_csv('../data/School Survey 2019.csv')
SS_17 <- SS_17%>%select(DBN,`School Name`,`Collaborative Teachers Score`:`Trust Score`)%>%
replace_with_na_all(condition = ~.x=='N/A')%>%
filter_all(any_vars(!is.na(.)))%>%
rename('17 Collaborative Teachers Score'='Collaborative Teachers Score',
'17 Effective School Leadership Score'=
'Effective School Leadership Score',
'17 Rigorous Instruction Score'='Rigorous Instruction Score',
'17 Supportive Environment Score'='Supportive Environment Score',
'17 Strong Family-Community Ties Score'=
'Strong Family-Community Ties Score',
'17 Trust Score'='Trust Score')
SS_18 <- SS_18%>%select(DBN,`Collaborative Teachers Score`:`Trust Score`)%>%
replace_with_na_all(condition = ~.x=='N/A')%>%
filter_all(any_vars(!is.na(.)))%>%
rename('18 Collaborative Teachers Score'='Collaborative Teachers Score',
'18 Effective School Leadership Score'=
'Effective School Leadership Score',
'18 Rigorous Instruction Score'='Rigorous Instruction Score',
'18 Supportive Environment Score'='Supportive Environment Score',
'18 Strong Family-Community Ties Score'=
'Strong Family-Community Ties Score',
'18 Trust Score'='Trust Score')
SS_19 <- SS_19%>%select(DBN,`Collaborative Teachers Score`:`Trust Score`)%>%
replace_with_na_all(condition = ~.x=='N/A')%>%
filter_all(any_vars(!is.na(.)))%>%
rename('19 Collaborative Teachers Score'='Collaborative Teachers Score',
'19 Effective School Leadership Score'=
'Effective School Leadership Score',
'19 Rigorous Instruction Score'='Rigorous Instruction Score',
'19 Supportive Environment Score'='Supportive Environment Score',
'19 Strong Family-Community Ties Score'=
'Strong Family-Community Ties Score',
'19 Trust Score'='Trust Score')
SS <- SS_17%>%inner_join(SS_18,by='DBN')%>%
inner_join(SS_19,by='DBN')%>%inner_join(select(SL,DBN),by='DBN')%>%
mutate(DBN=str_extract(DBN, '[A-Z][0-9][0-9][0-9]'))%>%rename('BN'='DBN')
View(SS)
df1 <- data.frame(SS[3,9,15])
indx1 <- which(!is.na(df1), arr.ind=TRUE)
colab_teacher <- df1[cbind(1:nrow(df1),tapply(indx1[,2], indx1[,1], FUN=max))]
colab_teacher
df1 <- data.frame(SSc(3,9,15)
df1 <- data.frame(SSc(3,9,15))
df1 <- data.frame(SS[c(3,9,15)])
indx1 <- which(!is.na(df1), arr.ind=TRUE)
colab_teacher <- df1[cbind(1:nrow(df1),tapply(indx1[,2], indx1[,1], FUN=max))]
SS[c(3,9,15)]
df1 <- data.frame(SS[c(3,9,15)])
df1
df1 <- data.frame(SS[c(3,9,15)])
indx1 <- which(!is.na(df1), arr.ind=TRUE)
colab_teacher <- df1[cbind(1:nrow(df1),tapply(indx1[,2], indx1[,1], FUN=max))]
colab_teacher
df1 <- data.frame(SS[c(3,9,15)])
indx1 <- which(!is.na(df1), arr.ind=TRUE)
colab_teacher <- df1[cbind(1:nrow(df1),tapply(indx1[,2], indx1[,1], FUN=max))]
colab_teacher
SS <- SS_17%>%inner_join(SS_18,by='DBN')%>%
inner_join(SS_19,by='DBN')%>%inner_join(select(SL,DBN),by='DBN')%>%
mutate(DBN=str_extract(DBN, '[A-Z][0-9][0-9][0-9]'))%>%rename('BN'='DBN')
SS
mutate(DBN=str_extract(DBN, '[A-Z][0-9][0-9][0-9]'))%>%rename('BN'='DBN')%>%
arrange(BN)
SS <- SS_17%>%inner_join(SS_18,by='DBN')%>%
inner_join(SS_19,by='DBN')%>%inner_join(select(SL,DBN),by='DBN')
SS <- SS_17%>%inner_join(SS_18,by='DBN')%>%
inner_join(SS_19,by='DBN')%>%inner_join(select(SL,DBN),by='DBN')%>%
mutate(DBN=str_extract(DBN, '[A-Z][0-9][0-9][0-9]'))%>%rename('BN'='DBN')%>%
arrange(BN)
SS
df1 <- data.frame(SS[c(3,9,15)])
indx1 <- which(!is.na(df1), arr.ind=TRUE)
colab_teacher <- df1[cbind(1:nrow(df1),tapply(indx1[,2], indx1[,1], FUN=max))]
colab_teacher
SS[c(3,9,15)]
df1 <- SS[c(3,9,15)]
df1 <- data.frame(df1)
indx1 <- which(!is.na(df1), arr.ind=TRUE)
colab_teacher <- df1[cbind(1:nrow(df1),tapply(indx1[,2], indx1[,1], FUN=max))]
colab_teacher
df2 <- SS[c(4,10,16)]
df2 <- data.frame(df2)
indx2 <- which(!is.na(df2), arr.ind=TRUE)
eff_sch_leader <- df2[cbind(1:nrow(df2),tapply(indx2[,2], indx2[,1], FUN=max))]
eff_sch_leader
df3 <- SS[c(4,10,16)]
df3 <- data.frame(df3)
indx3 <- which(!is.na(df3), arr.ind=TRUE)
rig_instr <- df3[cbind(1:nrow(df3),tapply(indx3[,2], indx3[,1], FUN=max))]
rig_instr
df3 <- SS[c(5,11,17)]
df3 <- data.frame(df3)
indx3 <- which(!is.na(df3), arr.ind=TRUE)
rig_instr <- df3[cbind(1:nrow(df3),tapply(indx3[,2], indx3[,1], FUN=max))]
rig_instr
trust_score_linechart('K001')
runApp()
df4 <- SS[c(6,12,18)]
df4 <- data.frame(df4)
indx4 <- which(!is.na(df4), arr.ind=TRUE)
suprt_env <- df4[cbind(1:nrow(df4),tapply(indx4[,2], indx4[,1], FUN=max))]
suprt_env
df5 <- SS[c(7,13,19)]
df5 <- data.frame(df5)
indx5 <- which(!is.na(df5), arr.ind=TRUE)
suprt_env <- df5[cbind(1:nrow(df5),tapply(indx5[,2], indx5[,1], FUN=max))]
df5 <- SS[c(7,13,19)]
df5 <- data.frame(df5)
indx5 <- which(!is.na(df5), arr.ind=TRUE)
fam_com_tie <- df5[cbind(1:nrow(df5),tapply(indx5[,2], indx5[,1], FUN=max))]
df4 <- SS[c(6,12,18)]
df4 <- data.frame(df4)
indx4 <- which(!is.na(df4), arr.ind=TRUE)
suprt_env <- df4[cbind(1:nrow(df4),tapply(indx4[,2], indx4[,1], FUN=max))]
fam_com_tie
df6 <- SS[c(8,14,20)]
df6 <- data.frame(df6)
indx6 <- which(!is.na(df6), arr.ind=TRUE)
trust_score <- df6[cbind(1:nrow(df6),tapply(indx6[,2], indx6[,1], FUN=max))]
trust_score
trust_score <- SS[20]
trust_score <- data.frame(SS[20])
trust_score
trust_score <- data.frame(SS[20])
trust_score
fam_com_tie
trust_score <- SS[20]
trust_score
trust_score <- as.vector(SS[20])
trust_score
trust_score <- as.vector(SS[20])
trust_score
typeof(trust_score)
cbind(fam_com_tie,trust_score)
trust_score <- SS[20]
cbind(fam_com_tie,trust_score)
trust_score <- as.numeric(SS[20])
trust_score <- SS[20]
trust_score <- SS[20]%>%rename(trust_score=`19 Trust Score`)
trust_score
cbind(fam_com_tie,trust_score)
cbind(colab_teacher,eff_sch_leader,rig_instr,suprt_env,fam_com_tie,trust_score)
SS_newest <- sapply(SS_newest, as.numeric )
SS_newest <- cbind(colab_teacher,eff_sch_leader,rig_instr,suprt_env,fam_com_tie,trust_score)
SS_newest <- sapply(SS_newest, as.numeric )
SS_newest
SS_newest[1,]
SS_newest[2,]
temp <- cbind(colab_teacher,eff_sch_leader,rig_instr,suprt_env,fam_com_tie,trust_score)
temp <- sapply(temp, as.numeric)
SS_newest <- cbind(SS[c(1,2)],temp)
SS_newest
save(SS_newest, file="../output/School_Survey_Newest.RData")
View(SS_newest)
df1 <- SS[c(3,9,15)]
df1 <- data.frame(df1)
indx1 <- which(!is.na(df1), arr.ind=TRUE)
colab_teacher <- df1[cbind(1:nrow(df1),tapply(indx1[,2], indx1[,1], FUN=max))]
df2 <- SS[c(4,10,16)]
df2 <- data.frame(df2)
indx2 <- which(!is.na(df2), arr.ind=TRUE)
eff_sch_leader <- df2[cbind(1:nrow(df2),tapply(indx2[,2], indx2[,1], FUN=max))]
df3 <- SS[c(5,11,17)]
df3 <- data.frame(df3)
indx3 <- which(!is.na(df3), arr.ind=TRUE)
rig_instr <- df3[cbind(1:nrow(df3),tapply(indx3[,2], indx3[,1], FUN=max))]
suprt_env <- SS[6]%>%rename(suprt_env=`17 Supportive Environment Score`)
df5 <- SS[c(7,13,19)]
df5 <- data.frame(df5)
indx5 <- which(!is.na(df5), arr.ind=TRUE)
fam_com_tie <- df5[cbind(1:nrow(df5),tapply(indx5[,2], indx5[,1], FUN=max))]
trust_score <- SS[20]%>%rename(trust_score=`19 Trust Score`)
temp <- cbind(colab_teacher,eff_sch_leader,rig_instr,suprt_env,fam_com_tie,trust_score)
temp
temp <- sapply(temp, as.numeric)
temp
temp <- cbind(colab_teacher,eff_sch_leader,rig_instr,suprt_env,fam_com_tie,trust_score)
temp
View(temp)
as.numeric(temp$colab_teacher)
temp$colab_teacher
temp
temp <- cbind(colab_teacher,eff_sch_leader,rig_instr,suprt_env,fam_com_tie,trust_score)
temp
as.chqracter(temp$colab_teacher)
as.character(temp$colab_teacher)
temp <- sapply(temp,as.character)%>%sapply(as.numeric)
temp
sapply(temp,as.character)
temp <- cbind(colab_teacher,eff_sch_leader,rig_instr,suprt_env,fam_com_tie,trust_score)
temp
apply(temp,2,as.character)
temp <- apply(temp,2,as.character)%>%apply(2,as.numeric)
temp
SS_newest <- cbind(SS[c(1,2)],temp)
SS_newest
save(SS_newest, file="../output/School_Survey_Newest.RData")
library(plotly)
library(tidyverse)
school_survey_hist('K001')
trust_score_linechart('K001')
trust_score_linechart <- function(bn){
ss <- SS%>%filter(BN==bn)
year <- c('2017','2018','2019')
trust <- as.numeric(c(ss$`17 Trust Score`,ss$`18 Trust Score`,ss$`19 Trust Score`))
tr <- as_tibble(cbind(year,trust))
ggplot(tr,aes(x=year,y=trust,group=1))+geom_line()+geom_point()+
labs(title='2019 Trust Score',ylab='trust score')+theme_light()
}
trust_score_linechart('K001')
trust_score_linechart <- function(bn){
ss <- SS%>%filter(BN==bn)
year <- c('2017','2018','2019')
trust <- as.numeric(c(ss$`17 Trust Score`,ss$`18 Trust Score`,ss$`19 Trust Score`))
tr <- as_tibble(cbind(year,trust))
ggplot(tr,aes(x=year,y=trust,group=1))+geom_line()+geom_point()+
labs(title='2019 Trust Score',ylab='trust score')+
theme(plot.title = element_text(hjust = 0.5))+theme_light()
}
trust_score_linechart('K001')
trust_score_linechart <- function(bn){
ss <- SS%>%filter(BN==bn)
year <- c('2017','2018','2019')
trust <- as.numeric(c(ss$`17 Trust Score`,ss$`18 Trust Score`,ss$`19 Trust Score`))
tr <- as_tibble(cbind(year,trust))
ggplot(tr,aes(x=year,y=trust,group=1))+geom_line()+geom_point()+
labs(title='2019 Trust Score',ylab='trust score')+
theme_light()+theme(plot.title = element_text(hjust = 0.5))
}
trust_score_linechart('K001')
load("/Users/kexinsu/Documents/GitHub/Spring2020-Project2-group-6/output/demographic_by_school.RData")
View(demographic_by_school)
trust_score_linechart <- function(bn){
ss <- SS%>%filter(BN==bn)
year <- c('2017','2018','2019')
trust <- as.numeric(c(ss$`17 Trust Score`,ss$`18 Trust Score`,ss$`19 Trust Score`))
tr <- as_tibble(cbind(year,trust))
#ggplot(tr,aes(x=year,y=trust,group=1))+geom_line()+geom_point()+
#labs(title='2019 Trust Score',ylab='trust score')+
#theme_light()+theme(plot.title = element_text(hjust = 0.5))
plot_ly(tr, x = ~year, y = ~trust, type = 'scatter', mode = 'lines')%>%
layout(title="Trust Score from 2017 to 2019")
}
trust_score_linechart('K001')
trust_score_linechart <- function(bn){
ss <- SS%>%filter(BN==bn)
year <- c('2017','2018','2019')
trust <- as.numeric(c(ss$`17 Trust Score`,ss$`18 Trust Score`,ss$`19 Trust Score`))
tr <- as_tibble(cbind(year,trust))
plot_ly(tr, x = ~year, y = ~trust, type = 'scatter', mode = 'lines')%>%
layout(title="Trust Score from 2017 to 2019",yaxis=list(title='trust score',range=c(1,5)))
}
trust_score_linechart('K001')
plot_ly(tr, x = ~year, y = ~trust, type = 'scatter', mode = 'lines')%>%
layout(title="Trust Score from 2017 to 2019",yaxis=list(title='trust score',range=seq(1,5)))
trust_score_linechart <- function(bn){
ss <- SS%>%filter(BN==bn)
year <- c('2017','2018','2019')
trust <- as.numeric(c(ss$`17 Trust Score`,ss$`18 Trust Score`,ss$`19 Trust Score`))
tr <- as_tibble(cbind(year,trust))
plot_ly(tr, x = ~year, y = ~trust, type = 'scatter', mode = 'lines')%>%
layout(title="Trust Score from 2017 to 2019",yaxis=list(title='trust score',range=seq(1,5)))
}
trust_score_linechart('K001')
plot_ly(tr, x = ~year, y = ~trust, type = 'scatter', mode = 'lines')%>%
layout(title="Trust Score from 2017 to 2019",yaxis=list(title='trust score',range=c(1,5)))
trust_score_linechart('K001')
trust_score_linechart <- function(bn){
ss <- SS%>%filter(BN==bn)
year <- c('2017','2018','2019')
trust <- as.numeric(c(ss$`17 Trust Score`,ss$`18 Trust Score`,ss$`19 Trust Score`))
tr <- as_tibble(cbind(year,trust))
plot_ly(tr, x = ~year, y = ~trust, type = 'scatter', mode = 'lines')%>%
layout(title="Trust Score from 2017 to 2019",yaxis=list(title='trust score',range=c(1,5)))
}
trust_score_linechart('K001')
trust_score_linechart <- function(bn){
ss <- SS%>%filter(BN==bn)
year <- c('2017','2018','2019')
trust <- as.numeric(c(ss$`17 Trust Score`,ss$`18 Trust Score`,ss$`19 Trust Score`))
tr <- as_tibble(cbind(year,trust))
plot_ly(tr, x = ~year, y = ~trust, type = 'scatter', mode = 'lines')%>%
layout(title="Trust Score from 2017 to 2019",yaxis=list(title='trust score',range=c(1,5)))
}
trust_score_linechart('K001')
trust_score_linechart('K002')
trust_score_linechart <- function(bn){
ss <- SS%>%filter(BN==bn)
year <- c('2017','2018','2019')
trust <- as.numeric(c(ss$`17 Trust Score`,ss$`18 Trust Score`,ss$`19 Trust Score`))
tr <- as_tibble(cbind(year,trust))
plot_ly(tr, x = ~year, y = ~trust, type = 'scatter', mode = 'lines')%>%
layout(title="Trust Score from 2017 to 2019",
yaxis=list(title='trust score',rangemode = "normal",range=c(1,5)))
}
trust_score_linechart('K002')
load('../output/School_Survey_newest.RData')
View(SS_newest)
ss <- SS_newest%>%filter(BN=='K001')
ss
ss <- SS_newest%>%filter(BN=='K001')
plotly(x=c('Collaborative Teachers Score','Effective School Leadership Score',
'Rigorous Instruction Score','Supportive Environment Score',
'Strong Family-Community Ties Score','Trust Score'),
y=c(ss$colab_teacher,ss$eff_sch_leader,ss$rig_instr,ss$suprt_env,ss$fam_com_tie,ss$trust_score))
plot_ly(x=c('Collaborative Teachers Score','Effective School Leadership Score',
'Rigorous Instruction Score','Supportive Environment Score',
'Strong Family-Community Ties Score','Trust Score'),
y=c(ss$colab_teacher,ss$eff_sch_leader,ss$rig_instr,ss$suprt_env,ss$fam_com_tie,ss$trust_score))
new <- cbind(c('Collaborative Teachers Score','Effective School Leadership Score',
'Rigorous Instruction Score','Supportive Environment Score',
'Strong Family-Community Ties Score','Trust Score'),
c(ss$colab_teacher,ss$eff_sch_leader,ss$rig_instr,ss$suprt_env,ss$fam_com_tie,ss$trust_score)
)
new
#ggplot(new,aes(new[,1]))
school_survey_hist('K002')
#ggplot(new,aes(new[,1]))
school_survey_hist('K001')
school_survey_hist <- function(bn){
ss <- SS_newest%>%filter(BN==bn)
plot_ly(x=c('Collaborative Teachers Score','Effective School Leadership Score',
'Rigorous Instruction Score','Supportive Environment Score',
'Strong Family-Community Ties Score','Trust Score'),
y=c(ss$colab_teacher,ss$eff_sch_leader,ss$rig_instr,ss$suprt_env,ss$fam_com_tie,ss$trust_score),
type='bar')
)
}
school_survey_hist <- function(bn){
ss <- SS_newest%>%filter(BN==bn)
plot_ly(x=c('Collaborative Teachers Score','Effective School Leadership Score',
'Rigorous Instruction Score','Supportive Environment Score',
'Strong Family-Community Ties Score','Trust Score'),
y=c(ss$colab_teacher,ss$eff_sch_leader,ss$rig_instr,ss$suprt_env,ss$fam_com_tie,ss$trust_score),
type='bar')
}
#ggplot(new,aes(new[,1]))
school_survey_hist('K001')
#ggplot(new,aes(new[,1]))
school_survey_hist('K002')
ggplot(aes(x=new[,1],y=new[,2]))+ geom_bar()
ggplot(new, aes(x=new[,1],y=new[,2]))+ geom_bar()
dataframe(new)
data.frame(new)
library(shiny)
library(leaflet)
library(tidyverse)
library(scales)
library(ggrepel)
library(stringr)
library(plotly)
load('../output/final.RData')
load('../output/demographic_by_school.RData')
load('../output/School_Survey17-19.RData')
load('../output/School_Survey_newest.RData')
new <- data.frame(new)
ggplot(new, aes(x=x1,y=x2))+ geom_bar()
new
new <- cbind(c('Collaborative Teachers Score','Effective School Leadership Score',
'Rigorous Instruction Score','Supportive Environment Score',
'Strong Family-Community Ties Score','Trust Score'),
c(ss$colab_teacher,ss$eff_sch_leader,ss$rig_instr,ss$suprt_env,ss$fam_com_tie,ss$trust_score)
)
ss <- SS_newest%>%filter(BN=='K001')
new <- cbind(c('Collaborative Teachers Score','Effective School Leadership Score',
'Rigorous Instruction Score','Supportive Environment Score',
'Strong Family-Community Ties Score','Trust Score'),
c(ss$colab_teacher,ss$eff_sch_leader,ss$rig_instr,ss$suprt_env,ss$fam_com_tie,ss$trust_score)
)
new <- data.frame(new)
ggplot(new, aes(x=X1,y=X2))+ geom_bar()
ggplot(new, aes(x=X1)+ geom_bar()
ggplot(new, aes(x=X1)）+ geom_bar()
ggplot(new, aes(x=X1))+ geom_bar()
ggplot(new, aes(x=X1,y=X2))+ geom_bar(stat = "identity")
ggplot(new, aes(x=as.factor(X1),y=X2,fill=as.factor(X1)))+ geom_bar(stat = "identity")
ggplot(new, aes(x=c('score 1','score 2','score 3','score 4','score 5','score 6'),
y=X2,fill=as.factor(X1)))+ geom_bar(stat = "identity")
new <- data.frame(new)%>%mutate(X1=as.factor(X1))%>%rename(`score type`=X1,score=X2).
new <- data.frame(new)%>%mutate(X1=as.factor(X1))%>%rename(`score type`=X1,score=X2)
ggplot(new, aes(x=c('score 1','score 2','score 3','score 4','score 5','score 6'),
y=X2,fill=as.factor(X1)))+ geom_bar(stat = "identity")
new <- data.frame(new)%>%mutate(X1=as.factor(X1))%>%rename(`score type`=X1,score=X2)
ggplot(new, aes(x=c('score 1','score 2','score 3','score 4','score 5','score 6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")
ggplot(new, aes(x=c('score 1','score 2','score 3','score 4','score 5','score 6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")+ylim(1,5)
ggplot(new, aes(x=c('score 1','score 2','score 3','score 4','score 5','score 6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")+ylim(1.0,5.0)
ggplot(new, aes(x=c('score 1','score 2','score 3','score 4','score 5','score 6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")
new
new <- data.frame(new)%>%mutate(X1=as.factor(X1),X2=as.numeric(X2))%>%rename(`score type`=X1,score=X2)
new <- cbind(c('Collaborative Teachers Score','Effective School Leadership Score',
'Rigorous Instruction Score','Supportive Environment Score',
'Strong Family-Community Ties Score','Trust Score'),
c(ss$colab_teacher,ss$eff_sch_leader,ss$rig_instr,ss$suprt_env,ss$fam_com_tie,ss$trust_score)
)
new <- data.frame(new)%>%mutate(X1=as.factor(X1),X2=as.numeric(X2))%>%rename(`score type`=X1,score=X2)
ggplot(new, aes(x=c('score 1','score 2','score 3','score 4','score 5','score 6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")
View(new)
new <- cbind(c('Collaborative Teachers Score','Effective School Leadership Score',
'Rigorous Instruction Score','Supportive Environment Score',
'Strong Family-Community Ties Score','Trust Score'),
c(ss$colab_teacher,ss$eff_sch_leader,ss$rig_instr,ss$suprt_env,ss$fam_com_tie,ss$trust_score)
)
new <- data.frame(new)%>%mutate(X1=as.factor(X1),X2=as.numeric(as.character(X2)))%>%rename(`score type`=X1,score=X2)
View(new)
ggplot(new, aes(x=c('score 1','score 2','score 3','score 4','score 5','score 6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")+ylim(1,5)
ggplot(new, aes(x=c('score 1','score 2','score 3','score 4','score 5','score 6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")
ggplot(new, aes(x=c('score 1','score 2','score 3','score 4','score 5','score 6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")+ylim(0,5)
ggplot(new, aes(x=c('score 1','score 2','score 3','score 4','score 5','score 6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")+ylim(0,5)+
geom_text(aes(x = c('score 1','score 2','score 3','score 4','score 5','score 6'),y = score, label = round(prop, 2)))
ggplot(new, aes(x=c('score 1','score 2','score 3','score 4','score 5','score 6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")+ylim(0,5)+
geom_text(aes(x = c('score 1','score 2','score 3','score 4','score 5','score 6'),y = score, label = round(score, 2)))
ggplot(new, aes(x=c('S1','S2','S3','S4','S5','S6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")+ylim(0,5)+
geom_text(aes(x = c('S1','S2','S3','S4','S5','S6'),
y = score, label = round(score, 2)))+
labs(title='Latest School Survey Score',xlab='score type')
ggplot(new, aes(x=c('S1','S2','S3','S4','S5','S6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")+ylim(0,5)+
geom_text(aes(x = c('S1','S2','S3','S4','S5','S6'),
y = score, label = round(score, 2)))+
labs(title='Latest School Survey Score',x='score type')
ggplot(new, aes(x=c('S1','S2','S3','S4','S5','S6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")+ylim(0,5)+
geom_text(aes(x = c('S1','S2','S3','S4','S5','S6'),
y = score, label = round(score, 2)))+
labs(title='Latest School Survey Score',x='score type')+theme_light()+
theme(plot.title = element_text(hjust = 0.5))
school_survey_hist('K002')
school_survey_hist('K001')
school_survey_hist('K005')
school_survey_hist <- function(bn){
ss <- SS_newest%>%filter(BN==bn)
plot_ly(x=c('Collaborative Teachers Score','Effective School Leadership Score',
'Rigorous Instruction Score','Supportive Environment Score',
'Strong Family-Community Ties Score','Trust Score'),
y=c(ss$colab_teacher,ss$eff_sch_leader,ss$rig_instr,ss$suprt_env,ss$fam_com_tie,ss$trust_score),
type='bar')%>%layout(yaxis=list(range=c(0,5)))
}
school_survey_hist('K005')
trust_score_linechart <- function(bn){
ss <- SS%>%filter(BN==bn)
year <- c('2017','2018','2019')
trust <- as.numeric(c(ss$`17 Trust Score`,ss$`18 Trust Score`,ss$`19 Trust Score`))
tr <- as_tibble(cbind(year,trust))
plot_ly(tr, x = ~year, y = ~trust, type = 'scatter', mode = 'lines')%>%
layout(title="Trust Score from 2017 to 2019",
yaxis=list(title='trust score',rangemode = "normal",range=c(0,5)))
}
trust_score_linechart('K005')
school_survey_hist('K001')
school_survey_hist <- function(bn){
ss <- SS_newest%>%filter(BN==bn)
plot_ly(x=c('Collaborative Teachers Score','Effective School Leadership Score',
'Rigorous Instruction Score','Supportive Environment Score',
'Strong Family-Community Ties Score','Trust Score'),
y=c(ss$colab_teacher,ss$eff_sch_leader,ss$rig_instr,ss$suprt_env,ss$fam_com_tie,ss$trust_score),
type='bar')%>%layout(title='Latest School Survey Score',
yaxis=list(title='score',range=c(0,5)))
}
school_survey_hist('K001')
ggplot(new, aes(x=c('S1','S2','S3','S4','S5','S6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")+ylim(0,5)+
geom_text(aes(x = c('S1','S2','S3','S4','S5','S6'),
y = score, label = round(score, 2)))+
labs(title='Latest School Survey Score',x='score type')+theme_light()+
theme(plot.title = element_text(hjust = 0.5))
trust_score_linechart('K005')
runApp()
school_survey_hist('k001')
school_survey_hist('k001')
school_survey_hist('K001')
school_survey_hist <- function(bn){
ss <- SS_newest%>%filter(BN==bn)
new <- cbind(c('Collaborative Teachers Score','Effective School Leadership Score',
'Rigorous Instruction Score','Supportive Environment Score',
'Strong Family-Community Ties Score','Trust Score'),
c(ss$colab_teacher,ss$eff_sch_leader,ss$rig_instr,ss$suprt_env,ss$fam_com_tie,ss$trust_score)
)
new <- data.frame(new)%>%mutate(X1=as.factor(X1),X2=as.numeric(as.character(X2)))%>%rename(`score type`=X1,score=X2)
ggplot(new, aes(x=c('S1','S2','S3','S4','S5','S6'),
y=score,fill=`score type`))+ geom_bar(stat = "identity")+ylim(0,5)+
geom_text(aes(x = c('S1','S2','S3','S4','S5','S6'),
y = score, label = round(score, 2)))+
labs(title='Latest School Survey Score',x='score type')+theme_light()+
theme(plot.title = element_text(hjust = 0.5))
}
school_survey_hist('K001')
runApp()
runApp()
runApp()
runApp()
runApp()
